import{r as g,b as k,j as e,C as j,h as p,i as f,a as v,A as c,G as o,B as l,S as E}from"./index-BV_oXJj9.js";import{u as D,S as P,H as F}from"./header-KFQOFhpR.js";import{u as C}from"./useMutation-CQub-guN.js";import{B as A}from"./badge-T7TlEvDT.js";import{I as S}from"./input-BlCgWzo0.js";import{T as I}from"./textarea-DDWaMa2A.js";import"./avatar-CL8PSgrs.js";function q(){const[m,i]=g.useState(""),[u,d]=g.useState(""),[x,N]=g.useState(""),[h,b]=g.useState(""),y=k(),{data:t,isLoading:M,error:w}=D({queryKey:["/api/telegram/status"],refetchInterval:3e4}),r=C({mutationFn:async s=>{const a=await fetch("/api/telegram/send-message",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});if(!a.ok)throw new Error("Failed to send message");return a.json()},onSuccess:()=>{i(""),y.invalidateQueries({queryKey:["/api/telegram/status"]})}}),n=C({mutationFn:async s=>{const a=await fetch("/api/telegram/broadcast",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});if(!a.ok)throw new Error("Failed to broadcast message");return a.json()},onSuccess:()=>{N(""),b(""),y.invalidateQueries({queryKey:["/api/telegram/status"]})}}),B=()=>{!m||!u||r.mutate({chatId:u,message:m})},T=()=>{if(!x||!h)return;const s=h.split(",").map(a=>a.trim()).filter(a=>a);s.length!==0&&n.mutate({message:x,chatIds:s})};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(j,{children:[e.jsx(p,{children:e.jsxs(f,{className:"flex items-center gap-2",children:[e.jsx("i",{className:"fab fa-telegram text-blue-500"}),"Telegram Bot Status"]})}),e.jsx(v,{children:M?e.jsxs("div",{className:"animate-pulse space-y-2",children:[e.jsx("div",{className:"h-4 bg-muted rounded w-3/4"}),e.jsx("div",{className:"h-4 bg-muted rounded w-1/2"})]}):w?e.jsx(c,{variant:"destructive",children:e.jsx(o,{children:"Failed to load Telegram bot status. Please check your configuration."})}):t?e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(A,{variant:t.connected?"default":"secondary",children:t.connected?"🟢 Connected":"🔴 Disconnected"}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:["@",t.botInfo.username]})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Bot ID:"})," ",t.botInfo.id]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Name:"})," ",t.botInfo.firstName]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Can Join Groups:"}),t.botInfo.canJoinGroups?" ✅":" ❌"]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Read Group Messages:"}),t.botInfo.canReadAllGroupMessages?" ✅":" ❌"]})]})]}):null})]}),e.jsxs(j,{children:[e.jsx(p,{children:e.jsx(f,{children:"Send Message"})}),e.jsxs(v,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Chat ID"}),e.jsx(S,{placeholder:"Enter chat ID (e.g., 123456789)",value:u,onChange:s=>d(s.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Message"}),e.jsx(I,{placeholder:"Enter your message...",value:m,onChange:s=>i(s.target.value),rows:3})]})]}),e.jsx(l,{onClick:B,disabled:!m||!u||r.isPending,className:"w-full",children:r.isPending?"Sending...":"Send Message"}),r.isError&&e.jsx(c,{variant:"destructive",children:e.jsxs(o,{children:["Failed to send message: ",r.error?.message]})}),r.isSuccess&&e.jsx(c,{children:e.jsxs(o,{children:["✅ Message sent successfully! Message ID: ",r.data?.messageId]})})]})]}),e.jsx(E,{}),e.jsxs(j,{children:[e.jsx(p,{children:e.jsx(f,{children:"Broadcast Message"})}),e.jsxs(v,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Chat IDs (comma-separated)"}),e.jsx(S,{placeholder:"123456789, 987654321, 555666777",value:h,onChange:s=>b(s.target.value)}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Enter multiple chat IDs separated by commas"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Broadcast Message"}),e.jsx(I,{placeholder:"Enter your broadcast message...",value:x,onChange:s=>N(s.target.value),rows:4})]}),e.jsx(l,{onClick:T,disabled:!x||!h||n.isPending,className:"w-full",variant:"outline",children:n.isPending?"Broadcasting...":"Broadcast Message"}),n.isError&&e.jsx(c,{variant:"destructive",children:e.jsxs(o,{children:["Failed to broadcast message: ",n.error?.message]})}),n.isSuccess&&e.jsx(c,{children:e.jsxs(o,{children:["✅ Broadcast completed! Check results: ",n.data?.results?.length," messages processed"]})})]})]}),e.jsxs(j,{children:[e.jsx(p,{children:e.jsx(f,{children:"Quick Actions"})}),e.jsx(v,{children:e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs(l,{variant:"outline",onClick:()=>{d("123456789"),i("/start")},children:[e.jsx("i",{className:"fas fa-play mr-2"}),"Send /start Command"]}),e.jsxs(l,{variant:"outline",onClick:()=>{d("123456789"),i("/help")},children:[e.jsx("i",{className:"fas fa-question-circle mr-2"}),"Send /help Command"]}),e.jsxs(l,{variant:"outline",onClick:()=>{d("123456789"),i("/status")},children:[e.jsx("i",{className:"fas fa-chart-bar mr-2"}),"Send /status Command"]}),e.jsxs(l,{variant:"outline",onClick:()=>{d("123456789"),i("/posts")},children:[e.jsx("i",{className:"fas fa-list mr-2"}),"Send /posts Command"]})]})})]})]})}function L(){return e.jsxs("div",{className:"flex h-screen overflow-hidden bg-background",children:[e.jsx(P,{}),e.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[e.jsx(F,{title:"Telegram Integration",subtitle:"Manage your Telegram bot and send messages",actions:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Bot Status:"}),e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"})]})}),e.jsx("main",{className:"flex-1 overflow-auto",children:e.jsx("div",{className:"p-6 max-w-6xl mx-auto",children:e.jsx(q,{})})})]})]})}export{L as default};
